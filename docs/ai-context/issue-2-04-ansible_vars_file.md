# Issue #2-04: Ansible ë³€ìˆ˜ ì •ì˜ ë° VM ë¦¬ìŠ¤íŠ¸ êµ¬ì¡°í™” (ë„¤íŠ¸ì›Œí¬/ID ê·œì¹™ ìˆ˜ì •)

## ğŸ“… ë‚ ì§œ: 2025-12-29
## ğŸ‘¤ ì°¸ì—¬ì: ì„ì„±í˜„, Gemini

## ğŸ’¬ ëŒ€í™” ìš”ì•½
1. **IP ëŒ€ì—­ëŒ€ ì¡°ì •**: 
   - Ubuntu ê¸°ë°˜ ì‹ ê·œ VM: `.13` ì´í›„ì¸ `.14`ë¶€í„° ìˆœì°¨ í• ë‹¹.
   - K8s ê¸°ë°˜ ì‹ ê·œ VM: `.30`ë¶€í„° ìˆœì°¨ í• ë‹¹.
2. **VMID ì²´ê³„ ë³€ê²½**:
   - K8s ì „ìš© ë…¸ë“œë“¤ì˜ VMIDë¥¼ `300`ë²ˆë¶€í„° ì‹œì‘í•˜ë„ë¡ ë³€ê²½.
3. **ìƒíƒœ ê´€ë¦¬ ë¡œì§**:
   - ëª¨ë“  ì‹ ê·œ VMì˜ `existing` ê¸°ë³¸ê°’ì„ `false`ë¡œ ì„¤ì •.
   - í”„ë¡œë¹„ì €ë‹ ì™„ë£Œ í›„ ìˆ˜ë™ ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¡œ `true`ë¡œ ë³€ê²½í•˜ì—¬ ì¤‘ë³µ ìƒì„±ì„ ë°©ì§€í•˜ëŠ” êµ¬ì¡° ì±„íƒ.

## ğŸ› ï¸ ê²°ì •ëœ ì‚¬í•­
- `vars/vm_list.yml`ì˜ IP ë° ID ì²´ê³„ë¥¼ ì•„ë˜ í™•ì •ì•ˆìœ¼ë¡œ ì—…ë°ì´íŠ¸í•¨.
- `existing: false` í•­ëª©ë§Œ í•„í„°ë§í•˜ì—¬ ì•¤ì„œë¸” í”„ë¡œë¹„ì €ë‹ ë£¨í”„ë¥¼ ìˆ˜í–‰í•¨.

---

## ğŸ“Š ìµœì¢… í™•ì • VM ë¦¬ìŠ¤íŠ¸ (ëª¨ë‹ˆí„°ë§ ì—­í•  ìˆ˜ì • ë°˜ì˜)

| êµ¬ë¶„ | VM ID | Hostname | IP (192.168.0.x) | Target Node | Template | ë¹„ê³  |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **ê¸°ì¡´** | 100 | `vm-bastion` | .10 | server-06 | - | Tailscale/Ansible Host |
| **ê¸°ì¡´** | 101 | `kafka-01` | .11 | server-01 | - | Broker 01 |
| **ê¸°ì¡´** | 102 | `kafka-02` | .12 | server-02 | - | Broker 02 |
| **ê¸°ì¡´** | 103 | `kafka-03` | .13 | server-03 | - | Broker 03 |
| **ì‹ ê·œ** | **104** | `minio-server` | .14 | server-04 | 901 | Object Storage (VM) |
| **ì‹ ê·œ** | **105** | `postgres-dw` | .15 | server-05 | 901 | Data Warehouse (VM) |
| **ì‹ ê·œ** | **106** | **`infra-prom-01`** | .16 | **server-06** | 901 | **VM/Host Prometheus ì „ìš©** |
| **ì‹ ê·œ** | **300** | `k8s-master-01` | .30 | server-01 | 902 | Control Plane |
| **ì‹ ê·œ** | **301** | `k8s-worker-01` | .31 | server-02 | 902 | Spark Worker 01 |
| **ì‹ ê·œ** | **302** | `k8s-worker-02` | .32 | server-03 | 902 | Spark Worker 02 |
| **ì‹ ê·œ** | **303** | `k8s-worker-03` | .33 | server-04 | 902 | Airflow/Services |
| **ì‹ ê·œ** | **304** | `data-gen-worker` | .34 | server-05 | 902 | Spike Generator |
| **ì‹ ê·œ** | **305** | **`k8s-monitor-01`** | .35 | **server-06** | 902 | **Grafana + K8s Prom Stack** |

---

## ğŸ—ï¸ ëª¨ë‹ˆí„°ë§ ì•„í‚¤í…ì²˜ íë¦„

1.  **ì¸í”„ë¼ ë ˆì´ì–´**: 6ëŒ€ì˜ Proxmox í˜¸ìŠ¤íŠ¸ì™€ Kafka/MinIO/Postgres VMë“¤ì— `node-exporter` ì„¤ì¹˜.
2.  **ìˆ˜ì§‘ ë ˆì´ì–´ (VM)**: `infra-prom-01(106)`ì´ Proxmox í˜¸ìŠ¤íŠ¸ ë° ê°œë³„ VM ë©”íŠ¸ë¦­ ìˆ˜ì§‘.
3.  **ìˆ˜ì§‘ ë ˆì´ì–´ (K8s)**: `k8s-monitor-01(305)`ì˜ Prometheus Operatorê°€ í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ ë©”íŠ¸ë¦­ ìˆ˜ì§‘.
4.  **ì‹œê°í™” ë ˆì´ì–´**: **K8s ë‚´ë¶€ Grafana(305)**ê°€ ë‘ í”„ë¡œë©”í…Œìš°ìŠ¤ ë°ì´í„°ë¥¼ í†µí•© ì¿¼ë¦¬:
    * **Internal**: `http://prometheus-operated.monitoring.svc:9090`
    * **External**: `http://192.168.0.16:9090` (infra-prom-01)

---
**Next Step**: `group_vars/all.yml` ìƒì„± ë° `provision_vms.yml` í”Œë ˆì´ë¶ êµ¬í˜„.